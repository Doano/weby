<% title ".pages" %>
<% breadcrumb :pages_trash %>
<p class="pull-right">
  <% with_permission do %>
    <%= link_to t(".new_page"),
      new_site_admin_page_path,
      class: "btn btn-success" %>
  <% end %>
  <% with_permission(action: :fronts) do %>
    <%= link_to t(".covers"), fronts_site_admin_pages_path, class: "btn" %>
  <% end %>
  <%= link_to t(:recycle_bin),            
    site_admin_pages_path(deleted: true),
    class: "btn btn-inverse" %>           
</p>
<div class="clearfix"></div>

<div id="pages">
  
  <% if @pages.empty? %>                                                               
      <div class="alert">                                                                
      <%= t(".none_page") %>                                                           
    </div>                                                                             
  <% else %>                                                                           
        <div class="pull-left"> <%= info_page @pages %> </div>                             
      <div class="pull-right"> <%= paginate @pages, remote: true %> </div>               
      <div class="clearfix"></div>                                                       
                                                                                         
        <table class="table table-striped table-condensed nowrap">                         
            <thead>                                                                        
              <tr>                                                                         
                <th width="270px"><%= t(".title") %></th>                                  
                <th width="90px"><%= sortable 'users.first_name', t(".author") %></th>     
                <th width="80px"><%= sortable 'tags.name', t(".category") %></th>          
                <th width="50px"><%= sortable 'pages.type', t(".type") %></th>             
                <th width="120px"><%= sortable 'pages.created_at', t(".created_at") %></th>
                <% with_permission(action: :toggle_field) do %>                            
                    <th><%= sortable 'pages.front', t(".cover") %></th>                      
                  <th><%= sortable 'pages.publish', t(".publish") %></th>                  
                  <th width="50px"></th>                                                   
                <% end %>                                                                  
              </tr>                                                                        
            </thead>                                                                       
            <tbody>                                                                        
              <% @pages.each do |page| %>                                                  
                <tr id="<%= page.id %>">                                                     
                <td>                                                                       
                  <%= title_with_flags(page) %>                                            
                </td>                                                                      
                <td><%= page.author.first_name %></td>                                     
                <td><%= raw categories_links(page.category_list) %></td>                   
                <td><%= t(".#{page.type.downcase}") %></td>                                
                <td><%= l(page.created_at, :format => :short) %></td>                      
                <% with_permission(action: :toggle_field) do %>                            
                    <td align="center" class="front">                                        
                    <%= status_icon(page, :front) %></td>                            
                  <td align="center" class="publish">                                      
                    <%= status_icon(page) %></td>                                   
                  <td>
                    <% if check_permission(Sites::Admin::RepositoriesController, [:destroy]) %>
                      <%= link_to icon('fire'), site_admin_page_path(page), :data => {:confirm => t("are_you_sure")}, :method => :delete %>
                    <% end %>
                    <% if check_permission(Sites::Admin::RepositoriesController, [:recover]) %>
                      <%= link_to icon('refresh'), recover_site_admin_page_path(page)  %>
                    <% end %>
                  </td>                                                                    
                <% end %>                                                                  
              </tr>                                                                        
            <% end %>                                                                      
            </tbody>                                                                       
          </table>                                                                         
                                                                                           
            <div class="pull-left"> <%= per_page_links @pages, true, :mini %> </div>           
            <div class="pull-right"> <%= paginate @pages, remote: true %> </div>               
            <div class="clearfix"></div>                                                       
          <% end %>                                                                            
                                                                                                 
</div>
